package com.fileup.model;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.oreilly.servlet.MultipartRequest;
import com.oreilly.servlet.multipart.DefaultFileRenamePolicy;

public class UpDownCommand {
	public String exec(HttpServletRequest request, HttpServletResponse response) {
		// 실제 파일 업로드 부분
		try {
			// 실제 저장 위치 구하기
			String realpath = request.getServletContext().getRealPath("upload");
			
			// 파라미터를 받을 때 request 대신에 사용할 객체 cos에서 지원
			MultipartRequest mr = new MultipartRequest(request, 
					realpath, // 저장 위치
					100*1024*1024, // 업로드 크기
					"utf-8",
					new DefaultFileRenamePolicy() // 파일 이름이 겹치면 파일 이름 뒤에 숫자 붙임
					);
			
			// 파라미터 받기
			String name = mr.getParameter("name");
			// 올릴 당시 이름
			String f_name = mr.getOriginalFileName("f_name");
			// 저장할 당시 이름
			String f_name2 = mr.getFilesystemName(f_name);
			String contentType = mr.getContentType("");
		} catch (Exception e) {
		}

		return "fileUpDown/result.jsp";
	}
}
